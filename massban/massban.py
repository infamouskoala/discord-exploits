import discord
from discord.ext import commands
import json
import os

# If you skid this, you're officially worse than a 16 year old Indian boy, I was 16 when I coded this.

red = "\033[1;31m"
green = "\033[1;32m"
yellow = "\033[1;33m"
white = "\033[1;37m"
intents = discord.Intents.all()

try:

    with open('config.json') as f:
        config = json.load(f)
    TOKEN = config["token"]
    PREFIX = config["prefix"]
    print(f"{green}[+]{white} Loaded Config..")

except Exception as e:

    autoConfig = '''{ 
    "token" : "enter token here",
    "prefix" : "koala",
}'''

    with open("config.json", "w") as f:
        f.write(autoConfig)

    print(f"{yellow}[X]{white} Add details in config.json and restart the script.")
    input()

bot = commands.Bot(command_prefix=PREFIX, case_insensitive=True, intents=intents)

@bot.event
async def on_ready():
    os.system("clear || cls")
    os.system("title Koala Massban")
    print(f"Waiting for {PREFIX}b in server...")

@bot.command()
async def b(ctx):
    await ctx.message.delete()
    i = 0
    for member in ctx.guild.members:
        try:
            await ctx.guild.ban(member, reason="github.com/infamouskoala")
            i = i+1
            print(f"{member.name} was {green}banned{white}")
            os.system(f"title Banned - {i}")
        except Exception as e:
            print(f"{member.name} was {red}not banned{white}")

try:
    bot.run(TOKEN)
except discord.errors.PrivilegedIntentsRequired as e:
    print(f"Invalid Bot Intents, In other words please enable bot intents in your bot section")
    input()
except discord.errors.LoginFailure as e:
    print(f"Invalid Token")
    input()
except Exception as e:
    print(f"Debug: {e}")
    input()